(window.webpackJsonp=window.webpackJsonp||[]).push([[175],{718:function(e,t,a){"use strict";a.r(t);var s=a(1),o=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"x-epoching"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#x-epoching"}},[e._v("#")]),e._v(" "),a("code",[e._v("x/epoching")])]),e._v(" "),a("h2",{attrs:{id:"abstract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[e._v("#")]),e._v(" Abstract")]),e._v(" "),a("p",[e._v("The epoching module allows modules to queue messages for execution at a certain block height. Each module will have its own instance of the epoching module, this allows each module to have its own message queue and own duration for epochs.")]),e._v(" "),a("h2",{attrs:{id:"example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[e._v("#")]),e._v(" Example")]),e._v(" "),a("p",[e._v("In this example, we are creating an epochkeeper for a module that will be used by the module to queue messages to be executed at a later point in time.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"dHlwZSBLZWVwZXIgc3RydWN0IHsKICBzdG9yZUtleSAgICAgICAgICAgc2RrLlN0b3JlS2V5CiAgY2RjICAgICAgICAgICAgICAgIGNvZGVjLkJpbmFyeU1hcnNoYWxlcgogIGVwb2NoS2VlcGVyICAgICAgICBlcG9jaGtlZXBlci5LZWVwZXIKfQoKLy8gTmV3S2VlcGVyIGNyZWF0ZXMgYSBuZXcgc3Rha2luZyBLZWVwZXIgaW5zdGFuY2UKZnVuYyBOZXdLZWVwZXIoY2RjIGNvZGVjLkJpbmFyeU1hcnNoYWxlciwga2V5IHNkay5TdG9yZUtleSkgS2VlcGVyIHsKIHJldHVybiBLZWVwZXJ7CiAgc3RvcmVLZXk6ICAgICAgICAgICBrZXksCiAgY2RjOiAgICAgICAgICAgICAgICBjZGMsCiAgZXBvY2hLZWVwZXI6ICAgICAgICBlcG9jaGtlZXBlci5OZXdLZWVwZXIoY2RjLCBrZXkpLAogfQp9Cg=="}}),e._v(" "),a("h3",{attrs:{id:"contents"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contents"}},[e._v("#")]),e._v(" Contents")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#state"}},[e._v("State")])])]),e._v(" "),a("h1",{attrs:{id:"state"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#state"}},[e._v("#")]),e._v(" State")]),e._v(" "),a("h2",{attrs:{id:"messages-queue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#messages-queue"}},[e._v("#")]),e._v(" Messages queue")]),e._v(" "),a("p",[e._v("Messages are queued to run at the end of each epoch. Queued messages have an epoch number and for each epoch number, the queues are iterated over and each message is executed.")]),e._v(" "),a("h3",{attrs:{id:"message-queues"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#message-queues"}},[e._v("#")]),e._v(" Message queues")]),e._v(" "),a("p",[e._v("Each module has one unique message queue that is specific to that module.")]),e._v(" "),a("h2",{attrs:{id:"actions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#actions"}},[e._v("#")]),e._v(" Actions")]),e._v(" "),a("p",[e._v("A module will add a message that implements the "),a("code",[e._v("sdk.Msg")]),e._v(" interface. These message will be executed at a later time (end of the next epoch).")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"dHlwZSBNc2cgaW50ZXJmYWNlIHsKICBwcm90by5NZXNzYWdlCgogIC8vIFJldHVybiB0aGUgbWVzc2FnZSB0eXBlLgogIC8vIE11c3QgYmUgYWxwaGFudW1lcmljIG9yIGVtcHR5LgogIFJvdXRlKCkgc3RyaW5nCgogIC8vIFJldHVybnMgYSBodW1hbi1yZWFkYWJsZSBzdHJpbmcgZm9yIHRoZSBtZXNzYWdlLCBpbnRlbmRlZCBmb3IgdXRpbGl6YXRpb24KICAvLyB3aXRoaW4gdGFncwogIFR5cGUoKSBzdHJpbmcKCiAgLy8gVmFsaWRhdGVCYXNpYyBkb2VzIGEgc2ltcGxlIHZhbGlkYXRpb24gY2hlY2sgdGhhdAogIC8vIGRvZXNuJ3QgcmVxdWlyZSBhY2Nlc3MgdG8gYW55IG90aGVyIGluZm9ybWF0aW9uLgogIFZhbGlkYXRlQmFzaWMoKSBlcnJvcgoKICAvLyBHZXQgdGhlIGNhbm9uaWNhbCBieXRlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBNc2cuCiAgR2V0U2lnbkJ5dGVzKCkgW11ieXRlCgogIC8vIFNpZ25lcnMgcmV0dXJucyB0aGUgYWRkcnMgb2Ygc2lnbmVycyB0aGF0IG11c3Qgc2lnbi4KICAvLyBDT05UUkFDVDogQWxsIHNpZ25hdHVyZXMgbXVzdCBiZSBwcmVzZW50IHRvIGJlIHZhbGlkLgogIC8vIENPTlRSQUNUOiBSZXR1cm5zIGFkZHJzIGluIHNvbWUgZGV0ZXJtaW5pc3RpYyBvcmRlci4KICBHZXRTaWduZXJzKCkgW11BY2NBZGRyZXNzCiB9Cg=="}}),e._v(" "),a("h2",{attrs:{id:"buffered-messages-export-import"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#buffered-messages-export-import"}},[e._v("#")]),e._v(" Buffered Messages Export / Import")]),e._v(" "),a("p",[e._v("For now, the "),a("code",[e._v("x/epoching")]),e._v(" module is implemented to export all buffered messages without epoch numbers. When state is imported, buffered messages are stored on current epoch to run at the end of current epoch.")]),e._v(" "),a("h2",{attrs:{id:"genesis-transactions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#genesis-transactions"}},[e._v("#")]),e._v(" Genesis Transactions")]),e._v(" "),a("p",[e._v("We execute epoch after execution of genesis transactions to see the changes instantly before node start.")]),e._v(" "),a("h2",{attrs:{id:"execution-on-epochs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#execution-on-epochs"}},[e._v("#")]),e._v(" Execution on epochs")]),e._v(" "),a("ul",[a("li",[e._v("Try executing the message for the epoch")]),e._v(" "),a("li",[e._v("If success, make changes as it is")]),e._v(" "),a("li",[e._v("If failure, try making revert extra actions done on handlers (e.g. EpochDelegationPool deposit)")]),e._v(" "),a("li",[e._v("If revert fail, panic")])])],1)}),[],!1,null,null,null);t.default=o.exports}}]);