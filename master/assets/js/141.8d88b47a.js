(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{751:function(t,e,l){"use strict";l.r(e);var c=l(1),d=Object(c.a)({},(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[l("h1",{attrs:{id:"module-app-testing"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#module-app-testing"}},[t._v("#")]),t._v(" Module & App Testing")]),t._v(" "),l("p",[t._v("The Cosmos SDK contains different types of "),l("a",{attrs:{href:"https://martinfowler.com/articles/practical-test-pyramid.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("tests"),l("OutboundLink")],1),t._v(".\nThese tests have different goals and are used at different stages of the development cycle.\nWe advice, as a general rule, to use tests at all stages of the development cycle.\nIt is adviced, as a chain developer, to test your application and modules in a similar way than the SDK.")]),t._v(" "),l("p",[t._v("The rationale behind testing can be found in "),l("a",{attrs:{href:"https://docs.cosmos.network/main/architecture/adr-059-test-scopes.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ADR-59"),l("OutboundLink")],1),t._v(".")]),t._v(" "),l("h2",{attrs:{id:"unit-tests"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#unit-tests"}},[t._v("#")]),t._v(" Unit Tests")]),t._v(" "),l("p",[t._v("Unit tests are the lowest test category of the "),l("a",{attrs:{href:"https://martinfowler.com/articles/practical-test-pyramid.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("test pyramid"),l("OutboundLink")],1),t._v(".\nAll packages and modules should have unit test coverage. Modules should have their dependencies mocked: this means mocking keepers.")]),t._v(" "),l("p",[t._v("The SDK uses "),l("code",[t._v("mockgen")]),t._v(" to generate mocks for keepers:")]),t._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"false",base64:"IyEvdXNyL2Jpbi9lbnYgYmFzaAoKbW9ja2dlbl9jbWQ9JnF1b3Q7Z28gcnVuIGdpdGh1Yi5jb20vZ29sYW5nL21vY2svbW9ja2dlbiZxdW90OwokbW9ja2dlbl9jbWQgLXNvdXJjZT1jbGllbnQvYWNjb3VudF9yZXRyaWV2ZXIuZ28gLXBhY2thZ2UgbW9ja3MgLWRlc3RpbmF0aW9uIHRlc3RzL21vY2tzL2FjY291bnRfcmV0cmlldmVyLmdvCiRtb2NrZ2VuX2NtZCAtcGFja2FnZSBtb2NrcyAtZGVzdGluYXRpb24gdGVzdHMvbW9ja3MvdGVuZGVybWludF90bV9kYl9EQi5nbyBnaXRodWIuY29tL3RlbmRlcm1pbnQvdG0tZGIgREIKJG1vY2tnZW5fY21kIC1zb3VyY2UgZGIvdHlwZXMuZ28gLXBhY2thZ2UgbW9ja3MgLWRlc3RpbmF0aW9uIHRlc3RzL21vY2tzL2RiL3R5cGVzLmdvCiRtb2NrZ2VuX2NtZCAtc291cmNlPXR5cGVzL21vZHVsZS9tb2R1bGUuZ28gLXBhY2thZ2UgbW9ja3MgLWRlc3RpbmF0aW9uIHRlc3RzL21vY2tzL3R5cGVzX21vZHVsZV9tb2R1bGUuZ28KJG1vY2tnZW5fY21kIC1zb3VyY2U9dHlwZXMvaW52YXJpYW50LmdvIC1wYWNrYWdlIG1vY2tzIC1kZXN0aW5hdGlvbiB0ZXN0cy9tb2Nrcy90eXBlc19pbnZhcmlhbnQuZ28KJG1vY2tnZW5fY21kIC1zb3VyY2U9dHlwZXMvcm91dGVyLmdvIC1wYWNrYWdlIG1vY2tzIC1kZXN0aW5hdGlvbiB0ZXN0cy9tb2Nrcy90eXBlc19yb3V0ZXIuZ28KJG1vY2tnZW5fY21kIC1wYWNrYWdlIG1vY2tzIC1kZXN0aW5hdGlvbiB0ZXN0cy9tb2Nrcy9ncnBjX3NlcnZlci5nbyBnaXRodWIuY29tL2dvZ28vcHJvdG9idWYvZ3JwYyBTZXJ2ZXIKJG1vY2tnZW5fY21kIC1wYWNrYWdlIG1vY2tzIC1kZXN0aW5hdGlvbiB0ZXN0cy9tb2Nrcy90ZW5kZXJtaW50X3RlbmRlcm1pbnRfbGlic19sb2dfREIuZ28gZ2l0aHViLmNvbS90ZW5kZXJtaW50L3RlbmRlcm1pbnQvbGlicy9sb2cgTG9nZ2VyCiRtb2NrZ2VuX2NtZCAtc291cmNlPW9ybS9tb2RlbC9vcm10YWJsZS9ob29rcy5nbyAtcGFja2FnZSBvcm1tb2NrcyAtZGVzdGluYXRpb24gb3JtL3Rlc3Rpbmcvb3JtbW9ja3MvaG9va3MuZ28KJG1vY2tnZW5fY21kIC1zb3VyY2U9eC9uZnQvZXhwZWN0ZWRfa2VlcGVycy5nbyAtcGFja2FnZSB0ZXN0dXRpbCAtZGVzdGluYXRpb24geC9uZnQvdGVzdHV0aWwvZXhwZWN0ZWRfa2VlcGVyc19tb2Nrcy5nbwokbW9ja2dlbl9jbWQgLXNvdXJjZT14L2ZlZWdyYW50L2V4cGVjdGVkX2tlZXBlcnMuZ28gLXBhY2thZ2UgdGVzdHV0aWwgLWRlc3RpbmF0aW9uIHgvZmVlZ3JhbnQvdGVzdHV0aWwvZXhwZWN0ZWRfa2VlcGVyc19tb2Nrcy5nbwokbW9ja2dlbl9jbWQgLXNvdXJjZT14L21pbnQvdHlwZXMvZXhwZWN0ZWRfa2VlcGVycy5nbyAtcGFja2FnZSB0ZXN0dXRpbCAtZGVzdGluYXRpb24geC9taW50L3Rlc3R1dGlsL2V4cGVjdGVkX2tlZXBlcnNfbW9ja3MuZ28KJG1vY2tnZW5fY21kIC1zb3VyY2U9eC9wYXJhbXMvcHJvcG9zYWxfaGFuZGxlcl90ZXN0LmdvIC1wYWNrYWdlIHRlc3R1dGlsIC1kZXN0aW5hdGlvbiB4L3BhcmFtcy90ZXN0dXRpbC9zdGFraW5nX2tlZXBlcl9tb2NrLmdvCiRtb2NrZ2VuX2NtZCAtc291cmNlPXgvY3Jpc2lzL3R5cGVzL2V4cGVjdGVkX2tlZXBlcnMuZ28gLXBhY2thZ2UgdGVzdHV0aWwgLWRlc3RpbmF0aW9uIHgvY3Jpc2lzL3Rlc3R1dGlsL2V4cGVjdGVkX2tlZXBlcnNfbW9ja3MuZ28KJG1vY2tnZW5fY21kIC1zb3VyY2U9eC9hdXRoL3R5cGVzL2V4cGVjdGVkX2tlZXBlcnMuZ28gLXBhY2thZ2UgdGVzdHV0aWwgLWRlc3RpbmF0aW9uIHgvYXV0aC90ZXN0dXRpbC9leHBlY3RlZF9rZWVwZXJzX21vY2tzLmdvCiRtb2NrZ2VuX2NtZCAtc291cmNlPXgvYXV0aC9hbnRlL2V4cGVjdGVkX2tlZXBlcnMuZ28gLXBhY2thZ2UgdGVzdHV0aWwgLWRlc3RpbmF0aW9uIHgvYXV0aC9hbnRlL3Rlc3R1dGlsL2V4cGVjdGVkX2tlZXBlcnNfbW9ja3MuZ28KJG1vY2tnZW5fY21kIC1zb3VyY2U9eC9hdXRoei9leHBlY3RlZF9rZWVwZXJzLmdvIC1wYWNrYWdlIHRlc3R1dGlsIC1kZXN0aW5hdGlvbiB4L2F1dGh6L3Rlc3R1dGlsL2V4cGVjdGVkX2tlZXBlcnNfbW9ja3MuZ28KJG1vY2tnZW5fY21kIC1zb3VyY2U9eC9iYW5rL3R5cGVzL2V4cGVjdGVkX2tlZXBlcnMuZ28gLXBhY2thZ2UgdGVzdHV0aWwgLWRlc3RpbmF0aW9uIHgvYmFuay90ZXN0dXRpbC9leHBlY3RlZF9rZWVwZXJzX21vY2tzLmdvCiRtb2NrZ2VuX2NtZCAtc291cmNlPXgvZ3JvdXAvdGVzdHV0aWwvZXhwZWN0ZWRfa2VlcGVycy5nbyAtcGFja2FnZSB0ZXN0dXRpbCAtZGVzdGluYXRpb24geC9ncm91cC90ZXN0dXRpbC9leHBlY3RlZF9rZWVwZXJzX21vY2tzLmdvCiRtb2NrZ2VuX2NtZCAtc291cmNlPXgvZXZpZGVuY2UvdHlwZXMvZXhwZWN0ZWRfa2VlcGVycy5nbyAtcGFja2FnZSB0ZXN0dXRpbCAtZGVzdGluYXRpb24geC9ldmlkZW5jZS90ZXN0dXRpbC9leHBlY3RlZF9rZWVwZXJzX21vY2tzLmdvCiRtb2NrZ2VuX2NtZCAtc291cmNlPXgvZGlzdHJpYnV0aW9uL3R5cGVzL2V4cGVjdGVkX2tlZXBlcnMuZ28gLXBhY2thZ2UgdGVzdHV0aWwgLWRlc3RpbmF0aW9uIHgvZGlzdHJpYnV0aW9uL3Rlc3R1dGlsL2V4cGVjdGVkX2tlZXBlcnNfbW9ja3MuZ28KJG1vY2tnZW5fY21kIC1zb3VyY2U9eC9zbGFzaGluZy90eXBlcy9leHBlY3RlZF9rZWVwZXJzLmdvIC1wYWNrYWdlIHRlc3R1dGlsIC1kZXN0aW5hdGlvbiB4L3NsYXNoaW5nL3Rlc3R1dGlsL2V4cGVjdGVkX2tlZXBlcnNfbW9ja3MuZ28KJG1vY2tnZW5fY21kIC1zb3VyY2U9eC9nZW51dGlsL3R5cGVzL2V4cGVjdGVkX2tlZXBlcnMuZ28gLXBhY2thZ2UgdGVzdHV0aWwgLWRlc3RpbmF0aW9uIHgvZ2VudXRpbC90ZXN0dXRpbC9leHBlY3RlZF9rZWVwZXJzX21vY2tzLmdvCiRtb2NrZ2VuX2NtZCAtc291cmNlPXgvZ292L3Rlc3R1dGlsL2V4cGVjdGVkX2tlZXBlcnMuZ28gLXBhY2thZ2UgdGVzdHV0aWwgLWRlc3RpbmF0aW9uIHgvZ292L3Rlc3R1dGlsL2V4cGVjdGVkX2tlZXBlcnNfbW9ja3MuZ28KJG1vY2tnZW5fY21kIC1zb3VyY2U9eC9zdGFraW5nL3R5cGVzL2V4cGVjdGVkX2tlZXBlcnMuZ28gLXBhY2thZ2UgdGVzdHV0aWwgLWRlc3RpbmF0aW9uIHgvc3Rha2luZy90ZXN0dXRpbC9leHBlY3RlZF9rZWVwZXJzX21vY2tzLmdvCiRtb2NrZ2VuX2NtZCAtc291cmNlPXgvYXV0aC92ZXN0aW5nL3R5cGVzL2V4cGVjdGVkX2tlZXBlcnMuZ28gLXBhY2thZ2UgdGVzdHV0aWwgLWRlc3RpbmF0aW9uIHgvYXV0aC92ZXN0aW5nL3Rlc3R1dGlsL2V4cGVjdGVkX2tlZXBlcnNfbW9ja3MuZ28K"}})],1),t._v(" "),l("p",[t._v("You can read more about mockgen "),l("a",{attrs:{href:"https://github.com/golang/mock",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),l("OutboundLink")],1),t._v(".")]),t._v(" "),l("h3",{attrs:{id:"example"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[t._v("#")]),t._v(" Example")]),t._v(" "),l("p",[t._v("As an example, we will walkthrough the "),l("a",{attrs:{href:"https://github.com/cosmos/cosmos-sdk/blob/a92c291880eb6240b7221173282fee0c5f2adb05/x/gov/keeper/keeper_test.go",target:"_blank",rel:"noopener noreferrer"}},[t._v("keeper tests"),l("OutboundLink")],1),t._v(" of the "),l("code",[t._v("x/gov")]),t._v(" module.")]),t._v(" "),l("p",[t._v("The "),l("code",[t._v("x/gov")]),t._v(" module has a "),l("code",[t._v("Keeper")]),t._v(" type requires a few external dependencies (ie. imports outside "),l("code",[t._v("x/gov")]),t._v(" to work properly).")]),t._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBOZXdLZWVwZXIoCgljZGMgY29kZWMuQmluYXJ5Q29kZWMsIGtleSBzdG9yZXR5cGVzLlN0b3JlS2V5LCBhdXRoS2VlcGVyIHR5cGVzLkFjY291bnRLZWVwZXIsCgliYW5rS2VlcGVyIHR5cGVzLkJhbmtLZWVwZXIsIHNrIHR5cGVzLlN0YWtpbmdLZWVwZXIsCglyb3V0ZXIgKmJhc2VhcHAuTXNnU2VydmljZVJvdXRlciwgY29uZmlnIHR5cGVzLkNvbmZpZywgYXV0aG9yaXR5IHN0cmluZywKKSAqS2VlcGVyIHs="}})],1),t._v(" "),l("p",[t._v("In order to only test "),l("code",[t._v("x/gov")]),t._v(", we mock the "),l("a",{attrs:{href:"https://docs.cosmos.network/v0.46/building-modules/keeper.html#type-definition",target:"_blank",rel:"noopener noreferrer"}},[t._v("expected keepers"),l("OutboundLink")],1),t._v(" and instantiate the "),l("code",[t._v("Keeper")]),t._v(" with the mocked dependencies. Note that we may need to configure the mocked dependencies to return the expected values:")]),t._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"CS8vIGdvbW9jayBpbml0aWFsaXphdGlvbnMKCWN0cmwgOj0gZ29tb2NrLk5ld0NvbnRyb2xsZXIodCkKCWFjY3RLZWVwZXIgOj0gZ292dGVzdHV0aWwuTmV3TW9ja0FjY291bnRLZWVwZXIoY3RybCkKCWJhbmtLZWVwZXIgOj0gZ292dGVzdHV0aWwuTmV3TW9ja0JhbmtLZWVwZXIoY3RybCkKCXN0YWtpbmdLZWVwZXIgOj0gZ292dGVzdHV0aWwuTmV3TW9ja1N0YWtpbmdLZWVwZXIoY3RybCkKCWFjY3RLZWVwZXIuRVhQRUNUKCkuR2V0TW9kdWxlQWRkcmVzcyh0eXBlcy5Nb2R1bGVOYW1lKS5SZXR1cm4oZ292QWNjdCkuQW55VGltZXMoKQoJYWNjdEtlZXBlci5FWFBFQ1QoKS5HZXRNb2R1bGVBY2NvdW50KGdvbW9jay5BbnkoKSwgdHlwZXMuTW9kdWxlTmFtZSkuUmV0dXJuKGF1dGh0eXBlcy5OZXdFbXB0eU1vZHVsZUFjY291bnQodHlwZXMuTW9kdWxlTmFtZSkpLkFueVRpbWVzKCkKCXRyYWNrTW9ja0JhbGFuY2VzKGJhbmtLZWVwZXIpCglzdGFraW5nS2VlcGVyLkVYUEVDVCgpLlRva2Vuc0Zyb21Db25zZW5zdXNQb3dlcihjdHgsIGdvbW9jay5BbnkoKSkuRG9BbmRSZXR1cm4oZnVuYyhjdHggc2RrLkNvbnRleHQsIHBvd2VyIGludDY0KSBtYXRoLkludCB7CgkJcmV0dXJuIHNkay5Ub2tlbnNGcm9tQ29uc2Vuc3VzUG93ZXIocG93ZXIsIG1hdGguTmV3SW50RnJvbVVpbnQ2NCgxMDAwMDAwKSkKCX0pLkFueVRpbWVzKCkKCXN0YWtpbmdLZWVwZXIuRVhQRUNUKCkuQm9uZERlbm9tKGN0eCkuUmV0dXJuKCZxdW90O3N0YWtlJnF1b3Q7KS5BbnlUaW1lcygpCglzdGFraW5nS2VlcGVyLkVYUEVDVCgpLkl0ZXJhdGVCb25kZWRWYWxpZGF0b3JzQnlQb3dlcihnb21vY2suQW55KCksIGdvbW9jay5BbnkoKSkuQW55VGltZXMoKQoJc3Rha2luZ0tlZXBlci5FWFBFQ1QoKS5JdGVyYXRlRGVsZWdhdGlvbnMoZ29tb2NrLkFueSgpLCBnb21vY2suQW55KCksIGdvbW9jay5BbnkoKSkuQW55VGltZXMoKQoJc3Rha2luZ0tlZXBlci5FWFBFQ1QoKS5Ub3RhbEJvbmRlZFRva2Vucyhnb21vY2suQW55KCkpLlJldHVybihtYXRoLk5ld0ludCgxMDAwMDAwMCkpLkFueVRpbWVzKCkKCgkvLyBHb3Yga2VlcGVyIGluaXRpYWxpemF0aW9ucwoJZ292S2VlcGVyIDo9IGtlZXBlci5OZXdLZWVwZXIoZW5jQ2ZnLkNvZGVjLCBrZXksIGFjY3RLZWVwZXIsIGJhbmtLZWVwZXIsIHN0YWtpbmdLZWVwZXIsIG1zciwgdHlwZXMuRGVmYXVsdENvbmZpZygpLCBnb3ZBY2N0LlN0cmluZygpKQ=="}})],1),t._v(" "),l("p",[t._v("This allows us to test the "),l("code",[t._v("x/gov")]),t._v(" module without having to import other modules.")]),t._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKCSZxdW90O3Rlc3RpbmcmcXVvdDsKCgkmcXVvdDtnaXRodWIuY29tL3N0cmV0Y2hyL3Rlc3RpZnkvcmVxdWlyZSZxdW90OwoJJnF1b3Q7Z2l0aHViLmNvbS9zdHJldGNoci90ZXN0aWZ5L3N1aXRlJnF1b3Q7CgoJJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay9iYXNlYXBwJnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL2NvZGVjJnF1b3Q7CglzaW10ZXN0dXRpbCAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3Rlc3R1dGlsL3NpbXMmcXVvdDsKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3gvZ292L2tlZXBlciZxdW90OwoJZ292dGVzdHV0aWwgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay94L2dvdi90ZXN0dXRpbCZxdW90OwoJJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay94L2dvdi90eXBlcyZxdW90OwoJdjEgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay94L2dvdi90eXBlcy92MSZxdW90OwoJJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay94L2dvdi90eXBlcy92MWJldGExJnF1b3Q7CgltaW50dHlwZXMgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay94L21pbnQvdHlwZXMmcXVvdDsKKQoKdHlwZSBLZWVwZXJUZXN0U3VpdGUgc3RydWN0IHsKCXN1aXRlLlN1aXRlCgoJY2RjICAgICAgICAgICAgICAgY29kZWMuQ29kZWMKCWN0eCAgICAgICAgICAgICAgIHNkay5Db250ZXh0Cglnb3ZLZWVwZXIgICAgICAgICAqa2VlcGVyLktlZXBlcgoJYWNjdEtlZXBlciAgICAgICAgKmdvdnRlc3R1dGlsLk1vY2tBY2NvdW50S2VlcGVyCgliYW5rS2VlcGVyICAgICAgICAqZ292dGVzdHV0aWwuTW9ja0JhbmtLZWVwZXIKCXN0YWtpbmdLZWVwZXIgICAgICpnb3Z0ZXN0dXRpbC5Nb2NrU3Rha2luZ0tlZXBlcgoJcXVlcnlDbGllbnQgICAgICAgdjEuUXVlcnlDbGllbnQKCWxlZ2FjeVF1ZXJ5Q2xpZW50IHYxYmV0YTEuUXVlcnlDbGllbnQKCWFkZHJzICAgICAgICAgICAgIFtdc2RrLkFjY0FkZHJlc3MKCW1zZ1NydnIgICAgICAgICAgIHYxLk1zZ1NlcnZlcgoJbGVnYWN5TXNnU3J2ciAgICAgdjFiZXRhMS5Nc2dTZXJ2ZXIKfQ=="}})],1),t._v(" "),l("p",[t._v("We can test then create unit tests using the newly created "),l("code",[t._v("Keeper")]),t._v(" instance.")]),t._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBUZXN0SW5jcmVtZW50UHJvcG9zYWxOdW1iZXIodCAqdGVzdGluZy5UKSB7Cglnb3ZLZWVwZXIsIF8sIF8sIF8sIF8sIGN0eCA6PSBzZXR1cEdvdktlZXBlcih0KQoKCXRwIDo9IFRlc3RQcm9wb3NhbAoJXywgZXJyIDo9IGdvdktlZXBlci5TdWJtaXRQcm9wb3NhbChjdHgsIHRwLCAmcXVvdDsmcXVvdDspCglyZXF1aXJlLk5vRXJyb3IodCwgZXJyKQoJXywgZXJyID0gZ292S2VlcGVyLlN1Ym1pdFByb3Bvc2FsKGN0eCwgdHAsICZxdW90OyZxdW90OykKCXJlcXVpcmUuTm9FcnJvcih0LCBlcnIpCglfLCBlcnIgPSBnb3ZLZWVwZXIuU3VibWl0UHJvcG9zYWwoY3R4LCB0cCwgJnF1b3Q7JnF1b3Q7KQoJcmVxdWlyZS5Ob0Vycm9yKHQsIGVycikKCV8sIGVyciA9IGdvdktlZXBlci5TdWJtaXRQcm9wb3NhbChjdHgsIHRwLCAmcXVvdDsmcXVvdDspCglyZXF1aXJlLk5vRXJyb3IodCwgZXJyKQoJXywgZXJyID0gZ292S2VlcGVyLlN1Ym1pdFByb3Bvc2FsKGN0eCwgdHAsICZxdW90OyZxdW90OykKCXJlcXVpcmUuTm9FcnJvcih0LCBlcnIpCglwcm9wb3NhbDYsIGVyciA6PSBnb3ZLZWVwZXIuU3VibWl0UHJvcG9zYWwoY3R4LCB0cCwgJnF1b3Q7JnF1b3Q7KQoJcmVxdWlyZS5Ob0Vycm9yKHQsIGVycikKCglyZXF1aXJlLkVxdWFsKHQsIHVpbnQ2NCg2KSwgcHJvcG9zYWw2LklkKQp9"}})],1),t._v(" "),l("h2",{attrs:{id:"integration-tests"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#integration-tests"}},[t._v("#")]),t._v(" Integration Tests")]),t._v(" "),l("p",[t._v("Integration tests are at the second level of the "),l("a",{attrs:{href:"https://martinfowler.com/articles/practical-test-pyramid.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("test pyramid"),l("OutboundLink")],1),t._v(".\nIn the SDK, we locate our integration tests under "),l("a",{attrs:{href:"https://github.com/cosmos/cosmos-sdk/tree/main/tests/integration",target:"_blank",rel:"noopener noreferrer"}},[l("code",[t._v("/tests/integrations")]),l("OutboundLink")],1),t._v(".")]),t._v(" "),l("p",[t._v("The goal of these integration tests is to test a component with a minimal application (i.e. not "),l("code",[t._v("simapp")]),t._v("). The minimal application is defined with the help of "),l("RouterLink",{attrs:{to:"/building-chain/depinject.html"}},[l("code",[t._v("depinject")])]),t._v(" â€“ the SDK dependency injection framework, and includes all necessary modules to test the component. With the helps of the SDK testing package, we can easily create a minimal application and start the application with a set of genesis transactions: "),l("a",{attrs:{href:"https://github.com/cosmos/cosmos-sdk/blob/main/testutil/sims/app_helpers.go",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/cosmos/cosmos-sdk/blob/main/testutil/sims/app_helpers.go"),l("OutboundLink")],1),t._v(".")],1),t._v(" "),l("h3",{attrs:{id:"example-2"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#example-2"}},[t._v("#")]),t._v(" Example")]),t._v(" "),l("p",[t._v("Here, we will walkthrough the integration tests of the "),l("code",[t._v("x/distribution")]),t._v(" module. The "),l("code",[t._v("x/distribution")]),t._v(" module has, in addition to keeper unit tests, integration tests that test the "),l("code",[t._v("x/distribution")]),t._v(" module with a minimal application. This is expected as you may want to test the "),l("code",[t._v("x/distribution")]),t._v(" module with actual application logic, instead of only mocked dependencies.")]),t._v(" "),l("p",[t._v("For creating a minimal application, we use "),l("a",{attrs:{href:"https://github.com/cosmos/cosmos-sdk/blob/main/testutil/sims/app_helpers.go#L98-L102",target:"_blank",rel:"noopener noreferrer"}},[l("code",[t._v("simtestutil.Setup")]),l("OutboundLink")],1),t._v(" and an "),l("RouterLink",{attrs:{to:"/building-chain/depinject.html"}},[l("code",[t._v("AppConfig")])]),t._v(" of the "),l("code",[t._v("x/distribution")]),t._v(" minimal dependencies.")],1),t._v(" "),l("p",[t._v("For instance, the "),l("code",[t._v("AppConfig")]),t._v(" of "),l("code",[t._v("x/distribution")]),t._v(" is defined as:")]),t._v(" "),l("ul",[l("li",[t._v("https://github.com/cosmos/cosmos-sdk/blob/main/x/distribution/testutil/app_config.go")])]),t._v(" "),l("p",[t._v("This is a stripped down version of the "),l("code",[t._v("simapp")]),t._v(" "),l("code",[t._v("AppConfig")]),t._v(":")]),t._v(" "),l("ul",[l("li",[t._v("https://github.com/cosmos/cosmos-sdk/blob/main/simapp/app_config.go")])]),t._v(" "),l("p",[l("em",[t._v("Note, you can as well use the "),l("code",[t._v("AppConfig")]),t._v(" configurator for creating an "),l("code",[t._v("AppConfig")]),t._v(" "),l("a",{attrs:{href:"https://github.com/cosmos/cosmos-sdk/blob/15b04c2a87e433fe97877a32162b96ba2ebf8982/x/slashing/app_test.go#L54-L61",target:"_blank",rel:"noopener noreferrer"}},[t._v("inline"),l("OutboundLink")],1),t._v(". There no difference between those two ways, use whichever you prefer.")])]),t._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"CWFwcCwgZXJyIDo9IHNpbXRlc3R1dGlsLlNldHVwKHRlc3R1dGlsLkFwcENvbmZpZywKCQkmYW1wO2JhbmtLZWVwZXIsCgkJJmFtcDtkaXN0cktlZXBlciwKCQkmYW1wO3N0YWtpbmdLZWVwZXIsCgkpCglyZXF1aXJlLk5vRXJyb3IodCwgZXJyKQ=="}})],1),t._v(" "),l("p",[t._v("Now the types are injected and we can use them for our tests:")]),t._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBUZXN0U2V0V2l0aGRyYXdBZGRyKHQgKnRlc3RpbmcuVCkgewoJdmFyICgKCQliYW5rS2VlcGVyICAgIGJhbmtrZWVwZXIuS2VlcGVyCgkJZGlzdHJLZWVwZXIgICBrZWVwZXIuS2VlcGVyCgkJc3Rha2luZ0tlZXBlciAqc3Rha2luZ2tlZXBlci5LZWVwZXIKCSkKCglhcHAsIGVyciA6PSBzaW10ZXN0dXRpbC5TZXR1cCh0ZXN0dXRpbC5BcHBDb25maWcsCgkJJmFtcDtiYW5rS2VlcGVyLAoJCSZhbXA7ZGlzdHJLZWVwZXIsCgkJJmFtcDtzdGFraW5nS2VlcGVyLAoJKQoJcmVxdWlyZS5Ob0Vycm9yKHQsIGVycikKCgljdHggOj0gYXBwLkJhc2VBcHAuTmV3Q29udGV4dChmYWxzZSwgdG1wcm90by5IZWFkZXJ7fSkKCglhZGRyIDo9IHNpbXRlc3R1dGlsLkFkZFRlc3RBZGRycyhiYW5rS2VlcGVyLCBzdGFraW5nS2VlcGVyLCBjdHgsIDIsIHNkay5OZXdJbnQoMTAwMDAwMDAwMCkpCgoJcGFyYW1zIDo9IGRpc3RyS2VlcGVyLkdldFBhcmFtcyhjdHgpCglwYXJhbXMuV2l0aGRyYXdBZGRyRW5hYmxlZCA9IGZhbHNlCglyZXF1aXJlLk5vRXJyb3IodCwgZGlzdHJLZWVwZXIuU2V0UGFyYW1zKGN0eCwgcGFyYW1zKSkKCgllcnIgPSBkaXN0cktlZXBlci5TZXRXaXRoZHJhd0FkZHIoY3R4LCBhZGRyWzBdLCBhZGRyWzFdKQoJcmVxdWlyZS5Ob3ROaWwodCwgZXJyKQoKCXBhcmFtcy5XaXRoZHJhd0FkZHJFbmFibGVkID0gdHJ1ZQoJcmVxdWlyZS5Ob0Vycm9yKHQsIGRpc3RyS2VlcGVyLlNldFBhcmFtcyhjdHgsIHBhcmFtcykpCgoJZXJyID0gZGlzdHJLZWVwZXIuU2V0V2l0aGRyYXdBZGRyKGN0eCwgYWRkclswXSwgYWRkclsxXSkKCXJlcXVpcmUuTmlsKHQsIGVycikKCglyZXF1aXJlLkVycm9yKHQsIGRpc3RyS2VlcGVyLlNldFdpdGhkcmF3QWRkcihjdHgsIGFkZHJbMF0sIGRpc3RyQWNjLkdldEFkZHJlc3MoKSkpCn0="}})],1),t._v(" "),l("h2",{attrs:{id:"simulations"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#simulations"}},[t._v("#")]),t._v(" Simulations")]),t._v(" "),l("p",[t._v("Simulations uses as well a minimal application, built with "),l("RouterLink",{attrs:{to:"/building-chain/depinject.html"}},[l("code",[t._v("depinject")])]),t._v(":")],1),t._v(" "),l("p",[t._v("Following is an example for "),l("code",[t._v("x/gov/")]),t._v(" simulations:")]),t._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBjcmVhdGVUZXN0U3VpdGUodCAqdGVzdGluZy5ULCBpc0NoZWNrVHggYm9vbCkgKHN1aXRlLCBzZGsuQ29udGV4dCkgewoJcmVzIDo9IHN1aXRle30KCglhcHAsIGVyciA6PSBzaW10ZXN0dXRpbC5TZXR1cChjb25maWd1cmF0b3IuTmV3QXBwQ29uZmlnKAoJCWNvbmZpZ3VyYXRvci5BdXRoTW9kdWxlKCksCgkJY29uZmlndXJhdG9yLlR4TW9kdWxlKCksCgkJY29uZmlndXJhdG9yLlBhcmFtc01vZHVsZSgpLAoJCWNvbmZpZ3VyYXRvci5CYW5rTW9kdWxlKCksCgkJY29uZmlndXJhdG9yLlN0YWtpbmdNb2R1bGUoKSwKCQljb25maWd1cmF0b3IuR292TW9kdWxlKCksCgkpLCAmYW1wO3Jlcy5BY2NvdW50S2VlcGVyLCAmYW1wO3Jlcy5CYW5rS2VlcGVyLCAmYW1wO3Jlcy5Hb3ZLZWVwZXIsICZhbXA7cmVzLlN0YWtpbmdLZWVwZXIsICZhbXA7cmVzLmNkYykKCXJlcXVpcmUuTm9FcnJvcih0LCBlcnIpCgoJY3R4IDo9IGFwcC5CYXNlQXBwLk5ld0NvbnRleHQoaXNDaGVja1R4LCB0bXByb3RvLkhlYWRlcnt9KQoKCXJlcy5BcHAgPSBhcHAKCXJldHVybiByZXMsIGN0eAp9"}})],1),t._v(" "),l("p",[l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ci8vIFRlc3RXZWlnaHRlZE9wZXJhdGlvbnMgdGVzdHMgdGhlIHdlaWdodHMgb2YgdGhlIG9wZXJhdGlvbnMuCmZ1bmMgVGVzdFdlaWdodGVkT3BlcmF0aW9ucyh0ICp0ZXN0aW5nLlQpIHsKCXN1aXRlLCBjdHggOj0gY3JlYXRlVGVzdFN1aXRlKHQsIGZhbHNlKQoJYXBwIDo9IHN1aXRlLkFwcAoJY3R4LldpdGhDaGFpbklEKCZxdW90O3Rlc3QtY2hhaW4mcXVvdDspCgoJY2RjIDo9IHN1aXRlLmNkYwoJYXBwUGFyYW1zIDo9IG1ha2Uoc2ltdHlwZXMuQXBwUGFyYW1zKQoKCXdlaWdodGVzT3BzIDo9IHNpbXVsYXRpb24uV2VpZ2h0ZWRPcGVyYXRpb25zKGFwcFBhcmFtcywgY2RjLCBzdWl0ZS5BY2NvdW50S2VlcGVyLAoJCXN1aXRlLkJhbmtLZWVwZXIsIHN1aXRlLkdvdktlZXBlciwgbW9ja1dlaWdodGVkUHJvcG9zYWxDb250ZW50KDMpLAoJKQoKCS8vIHNldHVwIDMgYWNjb3VudHMKCXMgOj0gcmFuZC5OZXdTb3VyY2UoMSkKCXIgOj0gcmFuZC5OZXcocykKCWFjY3MgOj0gZ2V0VGVzdGluZ0FjY291bnRzKHQsIHIsIHN1aXRlLkFjY291bnRLZWVwZXIsIHN1aXRlLkJhbmtLZWVwZXIsIHN1aXRlLlN0YWtpbmdLZWVwZXIsIGN0eCwgMykKCglleHBlY3RlZCA6PSBbXXN0cnVjdCB7CgkJd2VpZ2h0ICAgICBpbnQKCQlvcE1zZ1JvdXRlIHN0cmluZwoJCW9wTXNnTmFtZSAgc3RyaW5nCgl9ewoJCXswLCB0eXBlcy5Nb2R1bGVOYW1lLCBzaW11bGF0aW9uLlR5cGVNc2dTdWJtaXRQcm9wb3NhbH0sCgkJezEsIHR5cGVzLk1vZHVsZU5hbWUsIHNpbXVsYXRpb24uVHlwZU1zZ1N1Ym1pdFByb3Bvc2FsfSwKCQl7MiwgdHlwZXMuTW9kdWxlTmFtZSwgc2ltdWxhdGlvbi5UeXBlTXNnU3VibWl0UHJvcG9zYWx9LAoJCXtzaW11bGF0aW9uLkRlZmF1bHRXZWlnaHRNc2dEZXBvc2l0LCB0eXBlcy5Nb2R1bGVOYW1lLCBzaW11bGF0aW9uLlR5cGVNc2dEZXBvc2l0fSwKCQl7c2ltdWxhdGlvbi5EZWZhdWx0V2VpZ2h0TXNnVm90ZSwgdHlwZXMuTW9kdWxlTmFtZSwgc2ltdWxhdGlvbi5UeXBlTXNnVm90ZX0sCgkJe3NpbXVsYXRpb24uRGVmYXVsdFdlaWdodE1zZ1ZvdGVXZWlnaHRlZCwgdHlwZXMuTW9kdWxlTmFtZSwgc2ltdWxhdGlvbi5UeXBlTXNnVm90ZVdlaWdodGVkfSwKCX0KCglmb3IgaSwgdyA6PSByYW5nZSB3ZWlnaHRlc09wcyB7CgkJb3BlcmF0aW9uTXNnLCBfLCBfIDo9IHcuT3AoKShyLCBhcHAuQmFzZUFwcCwgY3R4LCBhY2NzLCBjdHguQ2hhaW5JRCgpKQoJCS8vIHJlcXVpcmUuTm9FcnJvcih0LCBlcnIpIC8vIFRPRE8gY2hlY2sgaWYgaXQgc2hvdWxkIGJlIE5vRXJyb3IKCgkJLy8gdGhlIGZvbGxvd2luZyBjaGVja3MgYXJlIHZlcnkgbXVjaCBkZXBlbmRlbnQgZnJvbSB0aGUgb3JkZXJpbmcgb2YgdGhlIG91dHB1dCBnaXZlbgoJCS8vIGJ5IFdlaWdodGVkT3BlcmF0aW9ucy4gaWYgdGhlIG9yZGVyaW5nIGluIFdlaWdodGVkT3BlcmF0aW9ucyBjaGFuZ2VzIHNvbWUgdGVzdHMKCQkvLyB3aWxsIGZhaWwKCQlyZXF1aXJlLkVxdWFsKHQsIGV4cGVjdGVkW2ldLndlaWdodCwgdy5XZWlnaHQoKSwgJnF1b3Q7d2VpZ2h0IHNob3VsZCBiZSB0aGUgc2FtZSZxdW90OykKCQlyZXF1aXJlLkVxdWFsKHQsIGV4cGVjdGVkW2ldLm9wTXNnUm91dGUsIG9wZXJhdGlvbk1zZy5Sb3V0ZSwgJnF1b3Q7cm91dGUgc2hvdWxkIGJlIHRoZSBzYW1lJnF1b3Q7KQoJCXJlcXVpcmUuRXF1YWwodCwgZXhwZWN0ZWRbaV0ub3BNc2dOYW1lLCBvcGVyYXRpb25Nc2cuTmFtZSwgJnF1b3Q7b3BlcmF0aW9uIE1zZyBuYW1lIHNob3VsZCBiZSB0aGUgc2FtZSZxdW90OykKCX0="}})],1),t._v(" "),l("h2",{attrs:{id:"end-to-end-tests"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#end-to-end-tests"}},[t._v("#")]),t._v(" End-to-end Tests")]),t._v(" "),l("p",[t._v("End-to-end tests are at the top of the "),l("a",{attrs:{href:"https://martinfowler.com/articles/practical-test-pyramid.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("test pyramid"),l("OutboundLink")],1),t._v(".\nThey must test the whole application flow, from the user perspective (for instance, CLI tests). They are located under "),l("a",{attrs:{href:"https://github.com/cosmos/cosmos-sdk/tree/main/tests/e2e",target:"_blank",rel:"noopener noreferrer"}},[l("code",[t._v("/tests/e2e")]),l("OutboundLink")],1),t._v(".")]),t._v(" "),l("p",[t._v("For that, the SDK is using "),l("code",[t._v("simapp")]),t._v(" but you should use your own application ("),l("code",[t._v("appd")]),t._v(").\nHere are some examples:")]),t._v(" "),l("ul",[l("li",[t._v("SDK E2E tests: "),l("a",{attrs:{href:"https://github.com/cosmos/cosmos-sdk/tree/main/tests/e2e",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/cosmos/cosmos-sdk/tree/main/tests/e2e"),l("OutboundLink")],1),t._v(".")]),t._v(" "),l("li",[t._v("Cosmos Hub E2E tests: "),l("a",{attrs:{href:"https://github.com/cosmos/gaia/tree/main/tests/e2e",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/cosmos/gaia/tree/main/tests/e2e"),l("OutboundLink")],1),t._v(".")]),t._v(" "),l("li",[t._v("Osmosis E2E tests: "),l("a",{attrs:{href:"https://github.com/osmosis-labs/osmosis/tree/main/tests/e2e",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/osmosis-labs/osmosis/tree/main/tests/e2e"),l("OutboundLink")],1),t._v(".")])]),t._v(" "),l("p",[l("em",[t._v("Note, the SDK is in the process of creating its E2E tests, as defined in "),l("a",{attrs:{href:"https://docs.cosmos.network/main/architecture/adr-059-test-scopes.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ADR-59"),l("OutboundLink")],1),t._v(". This page will eventually be updated with better examples.")])]),t._v(" "),l("h2",{attrs:{id:"summary"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#summary"}},[t._v("#")]),t._v(" Summary")]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",[t._v("Scope")]),t._v(" "),l("th",[t._v("App Fixture")]),t._v(" "),l("th",[t._v("Mocks?")])])]),t._v(" "),l("tbody",[l("tr",[l("td",[t._v("Unit")]),t._v(" "),l("td",[t._v("None")]),t._v(" "),l("td",[t._v("Yes")])]),t._v(" "),l("tr",[l("td",[t._v("Integration")]),t._v(" "),l("td",[l("code",[t._v("depinject")])]),t._v(" "),l("td",[t._v("Some")])]),t._v(" "),l("tr",[l("td",[t._v("Simulation")]),t._v(" "),l("td",[l("code",[t._v("depinject")])]),t._v(" "),l("td",[t._v("No")])]),t._v(" "),l("tr",[l("td",[t._v("E2E")]),t._v(" "),l("td",[l("code",[t._v("appd")])]),t._v(" "),l("td",[t._v("No")])])])])])}),[],!1,null,null,null);e.default=d.exports}}]);